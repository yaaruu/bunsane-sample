# Connection settings
listen_addresses = '*'               # Listen on all addresses
max_connections = 200                # Higher for production concurrency (monitor load)
# Adjust based on your needs Configuration
# Add these to your postgresql.conf for better ECS query performance

# Memory settings for better sorting and hashing
work_mem = '64MB'                    # Balanced for production (increase per query if needed)
maintenance_work_mem = '256MB'       # For index creation/maintenance
shared_buffers = '1GB'               # 25% of RAM on production servers (adjust based on hardware)
temp_buffers = '16MB'                # Temp buffer memory
wal_buffers = '16MB'                 # WAL buffer memory
autovacuum_work_mem = '256MB'        # Autovacuum memory

# Parallel processing
max_parallel_workers_per_gather = 4   # More parallel workers
max_parallel_workers = 8              # Total parallel workers
max_parallel_maintenance_workers = 4  # For maintenance operations

# Query planning
random_page_cost = 1.1               # SSD optimization
effective_cache_size = '2GB'          # Tell planner about cache size (adjust to ~75% of RAM)
hash_mem_multiplier = 2.0             # Multiplier for hash memory

# Write performance (production-safe)
synchronous_commit = on              # Ensure durability (default)
fsync = on                           # Enable fsync for data safety
full_page_writes = on                # Protect against partial writes
checkpoint_timeout = '5min'          # Frequent checkpoints for recovery
max_wal_size = '1GB'                 # WAL size for balanced checkpoints
wal_level = replica                  # For replication if needed
archive_mode = off                   # Disable archiving unless required

# Logging for performance monitoring
log_line_prefix = '%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h '
log_statement = 'ddl'                # Log schema changes
log_temp_files = 0                   # Log temp file usage
log_checkpoints = on                 # Monitor checkpoints

